library(tidyverse)
customers <- read_csv("data/mall_customers.csv")
head(customers)
dim(customers)
head(customers)
skimr::skim(customers)
head(customers)
skimr::skim(customers)
library(janitor)
library(fastDummies)
library(broom)
library(tidyverse)
library(factoextra)
head(customers)
customers %>%
clean_names() #%>%
num_customers <- customers %>%
clean_names() %>%
select(annual_income_k, spending_score_1_100)
num_customers
ggplot(num_customers, aes(x = annual_income_k, y = spending_score_1_100)) +
geom_point()
skimr::skim(customers)
customers_scale <- num_customers %>%
mutate_if(is.numeric, scale)
customers_scale
customers_scale %>%
as_tibble() %>%
pivot_longer(cols = c(annual_income_k, spending_score_1_100),
names_to = "score_income",
values_to = "value") %>%
group_by(type) %>%
summarise(mean = round(mean(value)),
sd = sd(value))
customers_scale %>%
as_tibble() %>%
pivot_longer(cols = c(annual_income_k, spending_score_1_100),
names_to = "score_income",
values_to = "value") %>%
group_by(score_income) %>%
summarise(mean = round(mean(value)),
sd = sd(value))
customers_scale %>%
as_tibble() %>%
pivot_longer(cols = c(annual_income_k, spending_score_1_100),
names_to = "score_income",
values_to = "value") #%>%
fviz_nbclust
?fviz_nbclust
# elbow method
fviz_nbclust(customers_scale,
kmeans,
method = "wss",
nastart = 25)
# elbow method
fviz_nbclust(customers_scale,
kmeans,
method = "wss",
nstart = 25)
fviz_nbclust(customers_scale,
kmeans,
method = "silhouette",
nstart = 25)
fviz_nbclust(customers_scale, kmeans, method = "gap_stat")
clustered_customers <- kmeans(customers_scale,
centers = 5,
nstart = 25)
clustered_customers
tidy(clustered_customers, col.names = colnames(customers_scale))
clusters <- augment(clustered_customers, customers)
clusters
clusters <- augment(clustered_customers, customers) %>%
clean_names()
clusters
clusters %>%
ggplot() +
aes(x = annual_income, y = spending_score_1_100, colour = cluster) +
geom_point()
clusters %>%
ggplot() +
aes(x = annual_income_k, y = spending_score_1_100, colour = cluster) +
geom_point()
#some more info on clusters
tidy(clustered_customers, col.names = colnames(customers))
# slightly more informative info per cluster:
clusters %>%
group_by(cluster) %>%
summarise(across(.col = is.numeric), .fns = ~mean(.x))
# slightly more informative info per cluster:
clusters %>%
group_by(cluster) %>%
summarise(across(.col = is.numeric(x)), .fns = ~ mean(.x))
# slightly more informative info per cluster:
clusters %>%
group_by(cluster) %>%
summarise(across(.col = is.numeric(.x)), .fns = ~ mean(.x))
# slightly more informative info per cluster:
clusters %>%
group_by(cluster) %>%
summarise(across(.col = is.numeric, .fns = ~ mean(.x)))
# slightly more informative info per cluster:
clusters %>%
select(-customer_id) %>%
group_by(cluster) %>%
summarise(across(.col = is.numeric, .fns = ~ mean(.x)))
clusters %>%
ggplot() +
aes(x = annual_income_k, y = spending_score_1_100, colour = cluster) +
geom_point() +
facet_wrap(~ gender)
clusters %>%
ggplot() +
aes(x = annual_income_k, y = age, colour = cluster) +
geom_point()
clusters %>%
ggplot() +
aes(x = spending_score_1_100, y = age, colour = cluster) +
geom_point()
clusters %>%
ggplot() +
aes(x = annual_income_k, y = age, colour = cluster) +
geom_point()
clusters %>%
ggplot() +
aes(x = annual_income_k, y = age, colour = cluster) +
geom_point()
clusters %>%
ggplot() +
aes(x = annual_income_k, y = spending_score_1_100, colour = cluster) +
geom_point() +
facet_wrap(~ gender) +
scale_fill_discrete(labels = c("low income, high spending",
"average income and spending",
"low income, low spending",
"high income, high spending,
high income, low spending"))
clusters %>%
ggplot() +
aes(x = annual_income_k, y = spending_score_1_100, colour = cluster) +
geom_point() +
facet_wrap(~ gender) +
scale_colour_discrete(labels = c("low income, high spending",
"average income and spending",
"low income, low spending",
"high income, high spending,
high income, low spending"))
clusters %>%
ggplot() +
aes(x = annual_income_k, y = spending_score_1_100, colour = cluster) +
geom_point() +
facet_wrap(~ gender) +
scale_colour_discrete(labels = c("low income, high spending",
"average income and spending",
"low income, low spending",
"high income, high spending",
"high income, low spending"))
