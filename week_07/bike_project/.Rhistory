library(tidyverse)
library(tsibbledata)
# explore data
nyc_bikes <- nyc_bikes
head(nyc_bikes)
glimpse(nyc_bikes)
library(skimr)
skim(nyc_bikes)
head(nyc_bikes)
library(lubridate)
## lets get separate columns for year, month, day of bike rent:
nyc_bikes_dates <- nyc_bikes %>%
mutate(year = year(start_time),
month = month(start_time),
day = day(start_time))
## lets get separate columns for year, month, day of bike rent:
nyc_bikes_dates <- nyc_bikes %>%
mutate(year = year(start_time),
month = month(start_time, label = TRUE, abbr = TRUE),
day = day(start_time))
nyc_bikes_dates
nyc_bikes_dates %>%
index_by(year) %>%
summarise(rental_per_year = n())
#open packages
library(tidyverse)
library(tsibble)
library(tsibbledata)
library(skimr)
library(lubridate)
nyc_bikes_dates %>%
index_by(year) %>%
summarise(rental_per_year = n())
nyc_bikes_dates %>%
distinct(year)
nyc_bikes_dates %>%
distinct(month)
nyc_bikes_dates %>%
index_by(year) %>%
summarise(rental_per_year = n())
nyc_bikes_dates %>%
index_by(month) %>%
summarise(rental_per_year = n())
library(ggplot2)
nyc_bikes_dates %>%
index_by(month) %>%
summarise(rental_per_month = n()) %>%
ggplot() +
aes(x = month, y = rental_per_month) +
geom_histogram()
nyc_bikes_dates %>%
index_by(month) %>%
summarise(rental_per_month = n()) %>%
ggplot() +
aes(x = month, y = rental_per_month) +
geom_barplot()
nyc_bikes_dates %>%
index_by(month) %>%
summarise(rental_per_month = n()) %>%
ggplot() +
aes(x = month, y = rental_per_month) +
geom_bar()
nyc_bikes_dates %>%
index_by(month) %>%
summarise(rental_per_month = n()) %>%
ggplot() +
aes(x = month) +
geom_histogram()
nyc_bikes_dates %>%
index_by(month) %>%
summarise(rental_per_month = n()) %>%
ggplot() +
aes(x = month) +
geom_bar()
nyc_bikes_dates %>%
index_by(month) %>%
summarise(rental_per_month = n()) %>%
ggplot() +
aes(x = month, y = rental_per_month) +
geom_bar()
nyc_bikes_dates %>%
index_by(month) %>%
summarise(rental_per_month = n()) %>%
ggplot() +
aes(x = month, y = rental_per_month) +
geom_col()
# lets check per season, with (Dec, Jan, Feb = Winter); (Mar, Apr, May = Spring); (Jun, Jul, Aug = Summer); (Sep, Okt, Nov: Autumn)
nyc_bikes_dates %>%
mutate(season = recode(month,
"Jan" = "Winter",
"Feb" = "Winter",
"Mar" = "Spring",
"Apr" = "Spring",
"May" = "Spring",
"Jun" = "Summer",
"Jul" = "Summer",
"Aug" = "Summer",
"Sep" = "Autumn",
"Oct" = "Autumn",
"Nov" = "Autumn",
"Dec" = "Winter"))
# lets check per season, with (Dec, Jan, Feb = Winter); (Mar, Apr, May = Spring); (Jun, Jul, Aug = Summer); (Sep, Okt, Nov: Autumn)
nyc_bikes_dates %>%
mutate(season = recode(month,
"Jan" = "Winter",
"Feb" = "Winter",
"Mar" = "Spring",
"Apr" = "Spring",
"May" = "Spring",
"Jun" = "Summer",
"Jul" = "Summer",
"Aug" = "Summer",
"Sep" = "Autumn",
"Oct" = "Autumn",
"Nov" = "Autumn",
"Dec" = "Winter")) %>%
index_by(season) %>%
summarise(rental_per_season = n()) %>%
ggplot() +
aes(x = season, y = rental_per_season) +
geom_col()
nyc_bikes_dates %>%
mutate(quarter = recode(month,
"Jan" = "Q1",
"Feb" = "Q1",
"Mar" = "Q1",
"Apr" = "Q2",
"May" = "Q2",
"Jun" = "Q2",
"Jul" = "Q3",
"Aug" = "Q3",
"Sep" = "Q3",
"Oct" = "Q4",
"Nov" = "Q4",
"Dec" = "Q4")) %>%
index_by(quarter) %>%
summarise(rental_per_quarter = n()) %>%
ggplot() +
aes(x = quarter, y = rental_per_quarter) +
geom_col()
## lets get separate columns for year, month, day of bike rent:
nyc_bikes_dates <- nyc_bikes %>%
mutate(year = year(start_time),
month = month(start_time, label = TRUE, abbr = TRUE),
day = day(start_time),
weekday = wday(start_time, label = TRUE, abbr = TRUE))
# weekdays
nyc_bikes_dates %>%
index_by(weekday) %>%
summarise(rental_per_weekday = n()) %>%
ggplot() +
aes(x = weekday, y = rental_per_weekday) +
geom_col()
#days
nyc_bikes_dates %>%
index_by(day) %>%
summarise(rental_per_day = n()) %>%
ggplot() +
aes(x = day, y = rental_per_day) +
geom_col()
# weekdays
nyc_bikes_dates %>%
index_by(weekday) %>%
summarise(rental_per_weekday = n()) %>%
ggplot() +
aes(x = weekday, y = rental_per_weekday) +
geom_col()
#days (not of interest!)
nyc_bikes_dates %>%
index_by(day) %>%
summarise(rental_per_day = n()) %>%
ggplot() +
aes(x = day, y = rental_per_day) +
geom_col()
# weekdays
nyc_bikes_dates %>%
index_by(weekday) %>%
summarise(rental_per_weekday = n()) %>%
ggplot() +
aes(x = weekday, y = rental_per_weekday) +
geom_col()
# weekdays
nyc_bikes_dates %>%
group_by(weekday) %>%
summarise(rental_per_weekday = n()) %>%
ggplot() +
aes(x = weekday, y = rental_per_weekday) +
geom_col()
# weekdays
nyc_bikes_dates %>%
index_by(weekday) %>%
summarise(rental_per_weekday = n()) %>%
ggplot() +
aes(x = weekday, y = rental_per_weekday) +
geom_col()
View(nyc_bikes_dates)
# gender
nyc_bikes_dates %>%
distinct(gender)
# gender
nyc_bikes_dates %>%
index_by(weekday) %>%
summarise(rental_per_weekday = n()) %>%
ggplot() +
aes(x = weekday, y = rental_per_weekday) +
geom_col() +
facet_wrap(~ gender)
# gender
nyc_bikes_dates %>%
index_by(weekday) %>%
summarise(rental_per_weekday = n()) %>%
ungroup() %>%
ggplot() +
aes(x = weekday, y = rental_per_weekday) +
geom_col() +
facet_wrap(~ gender)
# gender
nyc_bikes_dates %>%
index_by(weekday) %>%
summarise(rental_per_weekday = n()) %>%
ggplot() +
aes(x = weekday, y = rental_per_weekday) +
geom_col() +
facet_wrap(~ gender)
nyc_bikes_dates %>%
ggplot() +
aes(x = weekday) +
geom_histogram() +
facet_wrap(~ gender)
nyc_bikes_dates %>%
ggplot() +
aes(x = weekday) +
geom_histogram() #+
nyc_bikes_dates %>%
ggplot() +
aes(x = weekday) +
geom_bar() #+
nyc_bikes_dates %>%
ggplot() +
aes(x = weekday) +
geom_bar() +
facet_wrap(~ gender)
nyc_bikes_dates %>%
mutate(season = recode(month,
"Jan" = "Winter",
"Feb" = "Winter",
"Mar" = "Spring",
"Apr" = "Spring",
"May" = "Spring",
"Jun" = "Summer",
"Jul" = "Summer",
"Aug" = "Summer",
"Sep" = "Autumn",
"Oct" = "Autumn",
"Nov" = "Autumn",
"Dec" = "Winter")) %>%
ggplot() +
aes(x = season) +
geom_bar() +
facet_wrap(~ gender)
# let's add age to the dataset
nyc_bikes_dates %>%
mutate(age = today() - year)
# let's add age to the dataset
nyc_bikes_dates %>%
mutate(age = today() - birth_year)
# let's add age to the dataset
nyc_bikes_dates %>%
mutate(age = 2018 - birth_year)
# let's add age to the dataset, and divide per age group
# 0-17, 18-25, 26-35, 35-50, 50-65, 66-up
nyc_bikes_dates %>%
mutate(age = 2018 - birth_year) %>%
mutate(age_group = case_when(
age < 18 ~ "0-17",
age >= 18 & age <= 25 ~ "18-25",
age > 25 & age <= 35 ~ "26-35",
age > 35 & age <= 50 ~ "36-50",
age > 50 & age <= 65 ~ "50-65",
age > 65 ~ "66-up"
))
#age group
nyc_bikes_dates %>%
ggplot() +
aes(x = weekday) +
geom_bar() +
facet_wrap(~ age_group)
# let's add age to the dataset, and divide per age group
# 0-17, 18-25, 26-35, 35-50, 50-65, 66-up
nyc_bikes_dates_age <- nyc_bikes_dates %>%
mutate(age = 2018 - birth_year) %>%
mutate(age_group = case_when(
age < 18 ~ "0-17",
age >= 18 & age <= 25 ~ "18-25",
age > 25 & age <= 35 ~ "26-35",
age > 35 & age <= 50 ~ "36-50",
age > 50 & age <= 65 ~ "50-65",
age > 65 ~ "66-up"
))
#age group
nyc_bikes_dates_age %>%
ggplot() +
aes(x = weekday) +
geom_bar() +
facet_wrap(~ age_group)
nyc_bikes_dates_age %>%
mutate(season = recode(month,
"Jan" = "Winter",
"Feb" = "Winter",
"Mar" = "Spring",
"Apr" = "Spring",
"May" = "Spring",
"Jun" = "Summer",
"Jul" = "Summer",
"Aug" = "Summer",
"Sep" = "Autumn",
"Oct" = "Autumn",
"Nov" = "Autumn",
"Dec" = "Winter")) %>%
ggplot() +
aes(x = season) +
geom_bar() +
facet_wrap(~ age_group)
nyc_bikes_dates_age %>%
mutate(season = recode(month,
"Jan" = "Winter",
"Feb" = "Winter",
"Mar" = "Spring",
"Apr" = "Spring",
"May" = "Spring",
"Jun" = "Summer",
"Jul" = "Summer",
"Aug" = "Summer",
"Sep" = "Autumn",
"Oct" = "Autumn",
"Nov" = "Autumn",
"Dec" = "Winter")) %>%
ggplot() +
aes(x = season) +
geom_bar() +
facet_wrap(~ age_group)
nyc_bikes_dates_age %>%
ggplot() +
aes(x = weekday) +
geom_bar() +
facet_grid(gender ~ age_group)
nyc_bikes_dates_age %>%
ggplot() +
aes(x = weekday) +
geom_bar() +
facet_grid(gender ~ age_group)
nyc_bikes_dates_age %>%
distinct(type)
nyc_bikes_dates_age %>%
ggplot() +
aes(x = weekday) +
geom_bar() +
facet_wrap(~ type)
nyc_bikes_dates_age %>%
mutate(trip_accumulative = row_number)
nyc_bikes_dates_age %>%
mutate(trip_accumulative = row_number())
nyc_bikes_dates_age %>%
mutate(trip_accumulative = row_number()) %>%
ggplot() +
aes(x = start_time, y = trip_accumulative) +
geom_line()
nyc_bikes_dates_age %>%
arrange(start_time)
nyc_bikes_dates_age %>%
arrange(start_time) %>%
mutate(trip_accumulative = row_number()) %>%
ggplot() +
aes(x = start_time, y = trip_accumulative, group = ) +
geom_line()
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
ggplot() +
aes(x = trip_time) +
geom_bar()
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
ggplot() +
aes(x = trip_time) +
geom_histogram()
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
ggplot() +
aes(x = trip_time) +
geom_histogram(binwidth = 5)
#trip times below 1 hour
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) # %>%
mutate(time_hours = as.numeric(trip_time, "hours") #%>%
#trip times below 1 hour
nyc_bikes_dates_age %>%
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) #%>%
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
ggplot() +
aes(x = trip_time) +
geom_histogram(binwidth = 5)
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
ggplot() +
aes(x = time_hours) +
geom_histogram(binwidth = 5)
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours <= 1)
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours <= 1) %>%
ggplot() +
aes(x = time_hours) +
geom_histogram(binwidth = 5)
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours <= 1) %>%
ggplot() +
aes(x = time_hours) +
geom_histogram()
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours <= 1) %>%
ggplot() +
aes(x = time_hours) +
geom_histogram(col = "white")
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours >= 1) %>%
ggplot() +
aes(x = time_hours) +
geom_histogram(col = "white")
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours >= 1) #%>%
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours >= 1) %>%
ggplot() +
aes(x = time_hours) +
geom_histogram(col = "white")
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours >= 1) %>%
ggplot() +
aes(x = time_hours) +
geom_histogram(col = "white", bins = 5)
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours >= 1) %>%
ggplot() +
aes(x = time_hours) +
geom_histogram(col = "white", bins = 60)
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours <= 1) %>%
ggplot() +
aes(x = time_hours, y = age) +
geom_point()
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours <= 1) %>%
filter(age < 75) %>%
ggplot() +
aes(x = time_hours, y = age) +
geom_point()
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours <= 1) %>%
filter(age < 75) %>%
ggplot() +
aes(x = time_hours, y = start_station) +
geom_point()
nyc_bikes_dates_age %>%
mutate(trip_time = stop_time - start_time) %>%
mutate(time_hours = as.numeric(trip_time, "hours")) %>%
filter(time_hours <= 1) %>%
filter(age < 75) %>%
ggplot() +
aes(x = time_hours, y = age) +
geom_point()
